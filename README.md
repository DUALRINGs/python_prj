# Проект: API для управления задачами

## Описание

Данный проект представляет собой API для управления задачами, созданный с использованием **FastAPI** и **SQLAlchemy**. Пользователи могут создавать, обновлять и удалять свои задачи, а также управлять своими учетными записями через RESTful интерфейс.

## Стек технологий

- **FastAPI**: Фреймворк для создания API на Python.
- **SQLAlchemy**: ORM для работы с базами данных.
- **Postgres**: Используемая СУБД (можно адаптировать под любую другую).
- **Passlib**: Библиотека для безопасного хеширования паролей.
- **JSON Web Token (JWT)**: Для аутентификации пользователей.
- **Alembic**: Создание миграций базы данных.

## Установка

1. **Склонируйте репозиторий**:
 ```
   git clone https://github.com/DUALRINGs/python_prj
```   
2. **Создайте SSL сертификаты**:
 ```
mkdir -p certs && \
cd certs && \
openssl genrsa -out jwt-private.pem 2048 && \
openssl rsa -in jwt-private.pem -pubout -out jwt-public.pem && \
cd ..
```

2. **Создайте виртуальное окружение и активируйте его**:
 ```
   python -m venv venv
```
   # Для Linux/Mac
   ```
   source venv/bin/activate
```
   


3. **Установите зависимости**:
 ```
   poetry install
   ```

4. **Настройте базу данных**, внесите необходимые изменения в настройки подключения, если это необходимо.

5. **Провидите миграции**:
 ```
   alembic upgrade head
   ```

6. **Запустите приложение**:
 ```
   python3 app/main.py
   ```


## Структура проекта

```
.
├── alembic/                      # Миграции базы данных
│   ├── versions/                 # Файлы миграций
│   ├── env.py                    # Конфигурация Alembic
│   └── script.py.mako            # Шаблон миграций
│
├── app/                          # Основное приложение
│   ├── auth/                     # Аутентификация
│   │   ├── fastapi_users_router.py
│   │   └── user_manager.py
│   │
│   ├── models/                   # Модели данных
│   │   ├── base.py               # Базовые модели
│   │   ├── task.py               # Модель задач
│   │   └── user.py               # Модель пользователей
│   │
│   ├── schemas/                  # Pydantic схемы
│   │   └── users.py
│   │
│   ├── tasks/                    # Логика задач
│   │   ├── crud.py               # Операции с БД
│   │   ├── schemas.py            # Схемы задач
│   │   └── views.py              # API эндпоинты
│   │
│   ├── users/                    # Логика пользователей
│   │   ├── crud.py
│   │   └── views.py
│   │
│   ├── config.py                 # Конфигурация
│   ├── main.py                   # Точка входа
│   └── routers.py                # Основные роутеры
│
├── certs/                        # SSL сертификаты
│   ├── jwt-private.pem           # Приватный ключ
│   └── jwt-public.pem            # Публичный ключ
│
├── tests/                        # Тесты
│   ├── test_auth.py              # Тесты аутентификации
│   ├── test_tasks.py             # Тесты задач
│   └── test_users.py             # Тесты пользователей
│
├── README.md                     # Документация
├── alembic.ini                   # Конфигурация миграций
├── pyproject.toml                # Зависимости
└── pytest.ini                    # Настройки тестов
```


## Эндпоинты

### Аутентификация

- **```POST /auth/token```** - Получить токен для аутентификации.

### Пользователи

- **```GET /users```** -
  Возвращает список всех пользователей.

- **```GET /users/{user_id}```** - 
  Возвращает информацию о пользователе по его ID.

- **```POST /users```** - 
  Создает нового пользователя. 
  *Необходимо передать параметры: `name`, `email`, и `password`.*

- **```PUT /users/{user_id}```** - 
  Обновляет информацию о пользователе.

- **```DELETE /users/{user_id}```** - 
  Удаляет пользователя.


### Задачи

- **```POST /tasks```** - 
  Создает новую задачу. 
  *Необходимо передать данные задачи, включая параметр `status`, который может быть: "Новая", "В процессе", "Завершена".*

- **```GET /tasks```** - 
  Возвращает список задач, связанных с текущим пользователем.

- **```PUT /tasks/{task_id}```** - 
  Обновляет информацию о задаче.

- **```DELETE /tasks/{task_id}```** - 
  Удаляет задачу.


## Запуск тестов

Чтобы запустить тесты в вашем проекте, выполните следующие шаги:

1. **Перейдите в корневую директорию проекта**, где находится папка `tests`.

2. **Выполните команду**:
   
 ```
pytest
```

   Эта команда автоматически найдет и выполнит все тесты, определенные в файлах, соответствующих шаблону `test_*.py` или `*_test.py`.

3. **Просмотрите результаты тестов** в терминале. Если некоторые тесты не прошли, `pytest` предоставит подробную информацию об ошибках.

4. **Дополнительные команды**:

   - Для более детального отчета о тестах:
     
 ```
pytest -v
```

   - Для запуска конкретного тестового файла:
     
 ```
pytest tests/test_users.py
```
     